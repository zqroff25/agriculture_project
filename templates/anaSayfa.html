<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FarMate - Çiftçi Asistanı</title>
  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com/3.4.16"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#4CAF50',
            secondary: '#8BC34A'
          },
          borderRadius: {
            button: '8px'
          }
        }
      }
    }
  </script>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">

  <!-- Manifest ve Favicon -->
  <link rel="manifest" href="/static/manifest.json" />
  <link rel="icon" type="image/png" href="/static/favicon-192.png" />
  <link rel="apple-touch-icon" href="/static/favicon-192.png" />
  <meta name="theme-color" content="#4CAF50" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<style>

:where([class^="ri-"])::before { content: "\f3c2"; }
body {
font-family: 'Poppins', sans-serif;
background-color: #f8f9fa;
}
.search-input:focus {
outline: none;
}
.plant-card:active {
transform: scale(0.98);
}
.disease-card:active {
transform: scale(0.98);
}
.medicine-card:active {
transform: scale(0.98);
}
.hide-scrollbar::-webkit-scrollbar {
    display: none;
}
.hide-scrollbar {
    -ms-overflow-style: none;  /* IE and Edge */
    scrollbar-width: none;  /* Firefox */
}
</style>
</head>
<body class="bg-gray-50">
<!-- Nav Bar -->
<!-- Nav Bar -->
<div class="fixed top-0 w-full bg-white shadow-sm z-50">
  <div class="flex items-center justify-between px-4 py-3">
    <div class="flex items-center space-x-2">
     <!--  <div><img src="/static/logo/logo.png" alt="Logo" width="120px" height="90px"></div> -->
      <span class="text-xl font-semibold text-gray-800">farmate</span>
    </div>
    <div class="flex items-center space-x-3">
      <div class="w-8 h-8 flex items-center justify-center cursor-pointer">
        <i class="ri-notification-3-line ri-lg text-gray-600"></i>
      </div>
      <div class="w-8 h-8 flex items-center justify-center cursor-pointer">
        <i class="ri-settings-3-line ri-lg text-gray-600"></i>
      </div>
    </div>
  </div>
</div>
<!-- Main Content -->
<div class="pt-16 pb-16 px-4">
<!-- Weather Widget -->
<div class="bg-gradient-to-r from-primary to-secondary rounded-lg p-4 mb-6 shadow-md">
<div class="flex justify-between items-center">
<div class="text-white">
<p class="text-sm font-medium">Ankara, Türkiye</p>
<p class="text-2xl font-semibold">24°C</p>
<p class="text-xs">16 Mayıs 2025, Cuma</p>
</div>
<div class="flex flex-col items-center">
<div class="w-12 h-12 flex items-center justify-center">
<i class="ri-sun-line ri-3x text-white"></i>
</div>
<p class="text-white text-xs mt-1">Güneşli</p>
</div>
</div>
<div class="flex justify-between mt-4 text-white text-xs">
<div class="flex flex-col items-center">
<span>Nem</span>
<span class="font-medium">45%</span>
</div>
<div class="flex flex-col items-center">
<span>Rüzgar</span>
<span class="font-medium">12 km/s</span>
</div>
<div class="flex flex-col items-center">
<span>Min</span>
<span class="font-medium">18°C</span>
</div>
<div class="flex flex-col items-center">
<span>Max</span>
<span class="font-medium">27°C</span>
</div>
</div>
</div>
<!-- Search Bar -->
<div class="relative mb-6">
    <div class="relative">
        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <i class="ri-search-line text-gray-400"></i>
        </div>
        <input type="text" 
               id="searchInput"
               class="search-input bg-white w-full pl-10 pr-4 py-3 rounded-lg border border-gray-200 focus:border-primary transition-colors" 
               placeholder="Bitki, hastalık veya ilaç türü ara..."
               autocomplete="off">
        <div class="absolute inset-y-0 right-0 pr-3 flex items-center">
            <button id="searchFilterBtn" class="text-gray-400 hover:text-primary">
                <i class="ri-filter-3-line"></i>
            </button>
        </div>
    </div>

    <!-- Arama Filtreleri -->
    <div id="searchFilters" class="hidden mt-2 bg-white rounded-lg shadow-lg p-4 border border-gray-200">
        <div class="space-y-3">
            <h3 class="text-sm font-medium text-gray-700">Kategoriler</h3>
            <div class="flex flex-wrap gap-2">
                <label class="inline-flex items-center">
                    <input type="checkbox" class="form-checkbox text-primary" value="bitki" checked>
                    <span class="ml-2 text-sm text-gray-600">Bitkiler</span>
                </label>
                <label class="inline-flex items-center">
                    <input type="checkbox" class="form-checkbox text-primary" value="hastalik" checked>
                    <span class="ml-2 text-sm text-gray-600">Hastalıklar</span>
                </label>
                <label class="inline-flex items-center">
                    <input type="checkbox" class="form-checkbox text-primary" value="ilac" checked>
                    <span class="ml-2 text-sm text-gray-600">İlaç Türleri</span>
                </label>
            </div>
        </div>
    </div>

    <!-- Arama Sonuçları -->
    <div id="searchResults" class="hidden absolute z-50 w-full mt-2 bg-white rounded-lg shadow-lg border border-gray-200 max-h-96 overflow-y-auto">
        <!-- Popüler Aramalar -->
        <div class="p-4 border-b border-gray-200">
            <h3 class="text-sm font-medium text-gray-700 mb-2">Popüler Aramalar</h3>
            <div class="flex flex-wrap gap-2">
                <button class="px-3 py-1 bg-gray-100 text-gray-600 text-sm rounded-full hover:bg-primary hover:text-white transition-colors">
                    Sarı Pas
                </button>
                <button class="px-3 py-1 bg-gray-100 text-gray-600 text-sm rounded-full hover:bg-primary hover:text-white transition-colors">
                    Süne
                </button>
                <button class="px-3 py-1 bg-gray-100 text-gray-600 text-sm rounded-full hover:bg-primary hover:text-white transition-colors">
                    Pancar
                </button>
                <button class="px-3 py-1 bg-gray-100 text-gray-600 text-sm rounded-full hover:bg-primary hover:text-white transition-colors">
                    Fungisit
                </button>
            </div>
        </div>

        <!-- Arama Sonuçları Listesi -->
        <div id="searchResultsList" class="divide-y divide-gray-200">
            <!-- Sonuçlar JavaScript ile doldurulacak -->
        </div>
    </div>
</div>
<!-- Plant Selection Section -->
<div class="mb-6">
<div class="flex justify-between items-center mb-4">
<h2 class="text-lg font-semibold text-gray-800">Bitki Türleri</h2>
<a href="https://readdy.ai/home/86346ab1-a89e-4c46-bc08-fd47f814f05d/73aa1c2b-d20a-45d4-a539-a24414e7ee7c" data-readdy="true" class="text-primary text-sm cursor-pointer">Tümünü Gör</a>
</div>
<div class="grid grid-cols-2 gap-3">
  <a href="/bitki/bugday" class="plant-card bg-white rounded-lg shadow-sm overflow-hidden cursor-pointer border border-gray-100 transition-all duration-200 active:bg-gray-50 flex flex-col items-center p-3">
    <div class="w-24 h-24 flex items-center justify-center bg-white mb-2">
      <img src="https://readdy.ai/api/search-image?query=icon%2C%203D%20vector%20illustration%2C%20wheat%20plant%20with%20golden%20grains%2C%20detailed%20stalks%2C%20agricultural%20crop%2C%20the%20icon%20should%20take%20up%2070%25%20of%20the%20frame%2C%20isolated%20on%20white%20background%2C%20centered%20composition%2C%20soft%20lighting%2C%20no%20shadows%2C%20clean%20and%20modern%20look%2C%20single%20object%20focus&width=200&height=200&seq=21&orientation=squarish" alt="Buğday" class="w-full h-full object-contain" />
    </div>
    <h3 class="text-sm font-medium text-center">Buğday</h3>
  </a>
  <a href="/bitki/arpa" class="plant-card bg-white rounded-lg shadow-sm overflow-hidden cursor-pointer border border-gray-100 transition-all duration-200 active:bg-gray-50 flex flex-col items-center p-3">
    <div class="w-24 h-24 flex items-center justify-center bg-white mb-2">
      <img src="https://readdy.ai/api/search-image?query=icon%2C%203D%20vector%20illustration%2C%20barley%20plant%20with%20golden%20spikes%2C%20detailed%20stalks%2C%20agricultural%20crop%2C%20the%20icon%20should%20take%20up%2070%25%20of%20the%20frame%2C%20isolated%20on%20white%20background%2C%20centered%20composition%2C%20soft%20lighting%2C%20no%20shadows%2C%20clean%20and%20modern%20look%2C%20single%20object%20focus&width=200&height=200&seq=22&orientation=squarish" alt="Arpa" class="w-full h-full object-contain" />
    </div>
    <h3 class="text-sm font-medium text-center">Arpa</h3>
  </a>
  <a href="/bitki/misir" class="plant-card bg-white rounded-lg shadow-sm overflow-hidden cursor-pointer border border-gray-100 transition-all duration-200 active:bg-gray-50 flex flex-col items-center p-3">
    <div class="w-24 h-24 flex items-center justify-center bg-white mb-2">
      <img src="https://readdy.ai/api/search-image?query=icon%2C%203D%20vector%20illustration%2C%20corn%20plant%20with%20golden%20ears%2C%20detailed%20leaves%2C%20agricultural%20crop%2C%20the%20icon%20should%20take%20up%2070%25%20of%20the%20frame%2C%20isolated%20on%20white%20background%2C%20centered%20composition%2C%20soft%20lighting%2C%20no%20shadows%2C%20clean%20and%20modern%20look%2C%20single%20object%20focus&width=200&height=200&seq=23&orientation=squarish" alt="Mısır" class="w-full h-full object-contain" />
    </div>
    <h3 class="text-sm font-medium text-center">Mısır</h3>
  </a>
  <a href="/bitki/nohut" class="plant-card bg-white rounded-lg shadow-sm overflow-hidden cursor-pointer border border-gray-100 transition-all duration-200 active:bg-gray-50 flex flex-col items-center p-3">
    <div class="w-24 h-24 flex items-center justify-center bg-white mb-2">
      <img src="https://readdy.ai/api/search-image?query=icon%2C%203D%20vector%20illustration%2C%20chickpea%20plant%20with%20pods%2C%20detailed%20leaves%2C%20agricultural%20crop%2C%20the%20icon%20should%20take%20up%2070%25%20of%20the%20frame%2C%20isolated%20on%20white%20background%2C%20centered%20composition%2C%20soft%20lighting%2C%20no%20shadows%2C%20clean%20and%20modern%20look%2C%20single%20object%20focus&width=200&height=200&seq=24&orientation=squarish" alt="Nohut" class="w-full h-full object-contain" />
    </div>
    <h3 class="text-sm font-medium text-center">Nohut</h3>
  </a>
  <a href="/bitki/aycicegi" class="plant-card bg-white rounded-lg shadow-sm overflow-hidden cursor-pointer border border-gray-100 transition-all duration-200 active:bg-gray-50 flex flex-col items-center p-3">
    <div class="w-24 h-24 flex items-center justify-center bg-white mb-2">
      <img src="https://readdy.ai/api/search-image?query=icon%2C%203D%20vector%20illustration%2C%20sunflower%20plant%20with%20bright%20flower%2C%20detailed%20leaves%2C%20agricultural%20crop%2C%20the%20icon%20should%20take%20up%2070%25%20of%20the%20frame%2C%20isolated%20on%20white%20background%2C%20centered%20composition%2C%20soft%20lighting%2C%20no%20shadows%2C%20clean%20and%20modern%20look%2C%20single%20object%20focus&width=200&height=200&seq=25&orientation=squarish" alt="Ayçiçeği" class="w-full h-full object-contain" />
    </div>
    <h3 class="text-sm font-medium text-center">Ayçiçeği</h3>
  </a>
  <a href="/bitki/pancar" class="plant-card bg-white rounded-lg shadow-sm overflow-hidden cursor-pointer border border-gray-100 transition-all duration-200 active:bg-gray-50 flex flex-col items-center p-3">
    <div class="w-24 h-24 flex items-center justify-center bg-white mb-2">
      <img src="https://readdy.ai/api/search-image?query=icon%2C%203D%20vector%20illustration%2C%20sugar%20beet%20plant%20with%20large%20root%2C%20detailed%20leaves%2C%20agricultural%20crop%2C%20the%20icon%20should%20take%20up%2070%25%20of%20the%20frame%2C%20isolated%20on%20white%20background%2C%20centered%20composition%2C%20soft%20lighting%2C%20no%20shadows%2C%20clean%20and%20modern%20look%2C%20single%20object%20focus&width=200&height=200&seq=26&orientation=squarish" alt="Pancar" class="w-full h-full object-contain" />
    </div>
    <h3 class="text-sm font-medium text-center">Pancar</h3>
  </a>
</div>
</div>
<!-- Bunları Biliyor Musunuz? Bölümü -->
<div class="mb-6">
  <div class="flex justify-between items-center mb-4 pl-4">
    <h2 class="text-lg font-semibold text-gray-800">Bunları Biliyor Musunuz?</h2>
    <a href="/bilgi-kartlari" class="text-primary text-sm cursor-pointer">Tümünü Gör</a>
  </div>
  <div class="overflow-x-auto pb-2 -mx-4 px-4">
    <div class="flex space-x-3 w-max">
        {% for kart in bilgi_kartlari %}
        <div class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300 w-72 flex-shrink-0">
            <div class="p-6">
                <div class="flex items-center mb-4">
                    {% if kart.link == 'bugday-hastaliklari' %}
                        <i class="ri-wheat-line text-2xl text-primary mr-3"></i>
                    {% elif kart.link == 'tarim-istatistikleri' %}
                        <i class="ri-bar-chart-line text-2xl text-primary mr-3"></i>
                    {% elif kart.link == 'iklim-degisikligi' %}
                        <i class="ri-sun-cloudy-line text-2xl text-primary mr-3"></i>
                    {% elif kart.link == 'akilli-tarim' %}
                        <i class="ri-smartphone-line text-2xl text-primary mr-3"></i>
                    {% elif kart.link == 'organik-tarim' %}
                        <i class="ri-leaf-line text-2xl text-primary mr-3"></i>
                    {% elif kart.link == 'tarim-teknolojileri' %}
                        <i class="ri-robot-line text-2xl text-primary mr-3"></i>
                    {% endif %}
                    <h3 class="text-xl font-semibold text-gray-800">{{ kart.baslik }}</h3>
                </div>
                <p class="text-gray-600 mb-4">
                    {{ kart.aciklama }}
                </p>
                <div class="flex justify-between items-center mt-4">
                    <span class="text-sm text-gray-500">{{ kart.tarih }}</span>
                    <a href="/bilgi/{{ kart.link }}" class="text-primary hover:text-primary-dark text-sm font-medium">
                        İncele <i class="ri-arrow-right-line ml-1"></i>
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
  </div>
</div>
<!-- Disease Information Section -->
<div class="mb-6">
  <div class="flex justify-between items-center mb-4 pl-4">
    <h2 class="text-lg font-semibold text-gray-800">Domates Hastalıkları</h2>
    <a href="https://readdy.ai/home/86346ab1-a89e-4c46-bc08-fd47f814f05d/73aa1c2b-d20a-45d4-a539-a24414e7ee7c" data-readdy="true" class="text-primary text-sm cursor-pointer">Tümünü Gör</a>
  </div>
  <div class="space-y-3 pl-4 pr-2">
    <div class="disease-card bg-white rounded-lg shadow-sm overflow-hidden cursor-pointer border border-gray-100">
      <div class="flex p-3">
        <div class="w-20 h-20 rounded-lg overflow-hidden flex-shrink-0">
          <img src="https://readdy.ai/api/search-image?query=close-up%20photograph%20of%20tomato%20plant%20leaf%20with%20early%20blight%20disease%2C%20showing%20brown%20spots%20with%20concentric%20rings%2C%20detailed%20texture%2C%20isolated%20against%20white%20background%2C%20clear%20symptoms%2C%20plant%20pathology%20reference%20image%2C%20high%20resolution&width=200&height=200&seq=5&orientation=squarish" alt="Erken Yanıklık" class="w-full h-full object-cover">
        </div>
        <div class="ml-3 flex-1">
          <h3 class="font-medium text-gray-800">Erken Yanıklık</h3>
          <p class="text-xs text-gray-600 line-clamp-2 mt-1">Yapraklarda kahverengi lekeler ve halkalı desenler oluşturan fungal bir hastalıktır.</p>
          <div class="flex items-center mt-2">
            <div class="flex-1">
              <div class="h-1.5 w-full bg-gray-200 rounded-full">
                <div class="h-1.5 bg-orange-500 rounded-full" style="width: 75%"></div>
              </div>
              <span class="text-xs text-gray-500">Şiddet: Yüksek</span>
            </div>
            <div class="w-6 h-6 flex items-center justify-center ml-2">
              <i class="ri-arrow-right-s-line text-primary"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="disease-card bg-white rounded-lg shadow-sm overflow-hidden cursor-pointer border border-gray-100">
      <div class="flex p-3">
        <div class="w-20 h-20 rounded-lg overflow-hidden flex-shrink-0">
          <img src="https://readdy.ai/api/search-image?query=close-up%20photograph%20of%20tomato%20plant%20leaf%20with%20late%20blight%20disease%2C%20showing%20dark%20brown%20patches%20with%20fuzzy%20white%20mold%2C%20detailed%20texture%2C%20isolated%20against%20white%20background%2C%20clear%20symptoms%2C%20plant%20pathology%20reference%20image%2C%20high%20resolution&width=200&height=200&seq=6&orientation=squarish" alt="Geç Yanıklık" class="w-full h-full object-cover">
        </div>
        <div class="ml-3 flex-1">
          <h3 class="font-medium text-gray-800">Geç Yanıklık</h3>
          <p class="text-xs text-gray-600 line-clamp-2 mt-1">Yapraklarda koyu kahverengi lekeler ve beyaz küf oluşturan tehlikeli bir hastalıktır.</p>
          <div class="flex items-center mt-2">
            <div class="flex-1">
              <div class="h-1.5 w-full bg-gray-200 rounded-full">
                <div class="h-1.5 bg-red-500 rounded-full" style="width: 90%"></div>
              </div>
              <span class="text-xs text-gray-500">Şiddet: Çok Yüksek</span>
            </div>
            <div class="w-6 h-6 flex items-center justify-center ml-2">
              <i class="ri-arrow-right-s-line text-primary"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>
<!-- Tab Bar -->
<div class="fixed bottom-0 w-full bg-white border-t border-gray-200 z-50">
<div class="grid grid-cols-4 h-16">
<div class="flex flex-col items-center justify-center cursor-pointer">
<div class="w-6 h-6 flex items-center justify-center">
<i class="ri-home-5-fill ri-lg text-primary"></i>
</div>
<span class="text-xs text-primary mt-1">Ana Sayfa</span>
</div>
<a href="https://readdy.ai/home/86346ab1-a89e-4c46-bc08-fd47f814f05d/37bfd909-cc15-46cf-80f4-2e9d2030479f" data-readdy="true" class="flex flex-col items-center justify-center">
<div class="w-6 h-6 flex items-center justify-center">
<i class="ri-plant-line ri-lg text-gray-500"></i>
</div>
<span class="text-xs text-gray-500 mt-1">Bitkilerim</span>
</a>
<div class="flex flex-col items-center justify-center cursor-pointer">
<div class="w-6 h-6 flex items-center justify-center">
<i class="ri-calendar-line ri-lg text-gray-500"></i>
</div>
<span class="text-xs text-gray-500 mt-1">Takvim</span>
</div>
<a href="/borsa" class="flex flex-col items-center justify-center">
<div class="w-6 h-6 flex items-center justify-center">
<i class="ri-line-chart-line ri-lg text-gray-500"></i>
</div>
<span class="text-xs text-gray-500 mt-1">Borsa</span>
</a>
</div>
</div>
</div>
</div>
</div>

<!-- Tarım Haberleri Bölümü -->
<section class="pt-4 pb-20 bg-gray-100">
    <div class="max-w-6xl mx-auto px-4">
        <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">Tarım Haberleri</h2>
        <div class="overflow-x-auto hide-scrollbar px-4 -mx-4">
            <div class="flex space-x-6" id="news-container">
                <!-- Haber öğeleri buraya yüklenecek -->
            </div>
        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
const plantCards = document.querySelectorAll('.plant-card');
plantCards.forEach(card => {
card.addEventListener('click', function() {
// Highlight selected plant
plantCards.forEach(c => c.classList.remove('border-primary'));
this.classList.add('border-primary');
});
});
const diseaseCards = document.querySelectorAll('.disease-card');
diseaseCards.forEach(card => {
card.addEventListener('click', function() {
// Show disease details (could expand to show more info)
this.classList.toggle('border-primary');
});
});

// Bunları Biliyor Musunuz Slider'ı için
const sliderContainer = document.querySelector('.overflow-x-auto');
const slider = sliderContainer.querySelector('.flex');
let isDown = false;
let startX;
let scrollLeft;

sliderContainer.addEventListener('mousedown', (e) => {
  isDown = true;
  sliderContainer.style.cursor = 'grabbing';
  startX = e.pageX - sliderContainer.offsetLeft;
  scrollLeft = sliderContainer.scrollLeft;
});

sliderContainer.addEventListener('mouseleave', () => {
  isDown = false;
  sliderContainer.style.cursor = 'grab';
});

sliderContainer.addEventListener('mouseup', () => {
  isDown = false;
  sliderContainer.style.cursor = 'grab';
});

sliderContainer.addEventListener('mousemove', (e) => {
  if (!isDown) return;
  e.preventDefault();
  const x = e.pageX - sliderContainer.offsetLeft;
  const walk = (x - startX) * 2; // Kaydırma hızı
  sliderContainer.scrollLeft = scrollLeft - walk;
});

// Dokunmatik cihazlar için
let touchStartX;
let touchScrollLeft;

sliderContainer.addEventListener('touchstart', (e) => {
  touchStartX = e.touches[0].pageX - sliderContainer.offsetLeft;
  touchScrollLeft = sliderContainer.scrollLeft;
});

sliderContainer.addEventListener('touchmove', (e) => {
  if (!touchStartX) return;
  const x = e.touches[0].pageX - sliderContainer.offsetLeft;
  const walk = (x - touchStartX) * 2;
  sliderContainer.scrollLeft = touchScrollLeft - walk;
});

sliderContainer.addEventListener('touchend', () => {
  touchStartX = null;
});

// Tümünü Gör butonu için
const tumunuGorLink = document.querySelector('a[href="#"][class*="text-primary"]');
tumunuGorLink.addEventListener('click', (e) => {
  e.preventDefault();
  // Tüm kartları göster
  sliderContainer.scrollTo({
    left: 0,
    behavior: 'smooth'
  });
});
});
</script>
<!-- Hava Durumu Widget'ı için JS -->
<script>
// OpenWeatherMap API anahtarını buraya yazdık
const OPENWEATHER_API_KEY = 'a6d5a4f3356cd42bd0014cb967b5f0e5';

function setWeather(city, temp, desc, icon, humidity, wind, min, max) {
  document.querySelector('.text-sm.font-medium').textContent = city + ', Türkiye';
  document.querySelector('.text-2xl.font-semibold').textContent = temp + '°C';
  document.querySelector('.text-xs.mt-1').textContent = desc;
  document.querySelector('.ri-sun-line').className = icon + ' ri-3x text-white';
  // Alt değerler
  const stats = document.querySelectorAll('.flex.justify-between.mt-4.text-white.text-xs .flex.flex-col.items-center');
  if(stats.length === 4) {
    stats[0].querySelector('span.font-medium').textContent = humidity + '%';
    stats[1].querySelector('span.font-medium').textContent = wind + ' km/s';
    stats[2].querySelector('span.font-medium').textContent = min + '°C';
    stats[3].querySelector('span.font-medium').textContent = max + '°C';
  }
}

function getWeatherByCoords(lat, lon) {
  fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${OPENWEATHER_API_KEY}&units=metric&lang=tr`)
    .then(res => res.json())
    .then(data => {
      const iconMap = {
        'Clear': 'ri-sun-line',
        'Clouds': 'ri-cloud-line',
        'Rain': 'ri-rainy-line',
        'Snow': 'ri-snowy-line',
        'Thunderstorm': 'ri-thunderstorms-line',
        'Drizzle': 'ri-drizzle-line',
        'Mist': 'ri-foggy-line',
        'Fog': 'ri-foggy-line',
      };
      setWeather(
        data.name,
        Math.round(data.main.temp),
        data.weather[0].description.charAt(0).toUpperCase() + data.weather[0].description.slice(1),
        iconMap[data.weather[0].main] || 'ri-sun-line',
        data.main.humidity,
        Math.round(data.wind.speed),
        Math.round(data.main.temp_min),
        Math.round(data.main.temp_max)
      );
    })
    .catch(() => setWeather('Ankara', '--', 'Bilinmiyor', 'ri-sun-line', '--', '--', '--', '--'));
}

function getWeatherByCity(city) {
  fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${OPENWEATHER_API_KEY}&units=metric&lang=tr`)
    .then(res => res.json())
    .then(data => {
      const iconMap = {
        'Clear': 'ri-sun-line',
        'Clouds': 'ri-cloud-line',
        'Rain': 'ri-rainy-line',
        'Snow': 'ri-snowy-line',
        'Thunderstorm': 'ri-thunderstorms-line',
        'Drizzle': 'ri-drizzle-line',
        'Mist': 'ri-foggy-line',
        'Fog': 'ri-foggy-line',
      };
      setWeather(
        data.name,
        Math.round(data.main.temp),
        data.weather[0].description.charAt(0).toUpperCase() + data.weather[0].description.slice(1),
        iconMap[data.weather[0].main] || 'ri-sun-line',
        data.main.humidity,
        Math.round(data.wind.speed),
        Math.round(data.main.temp_min),
        Math.round(data.main.temp_max)
      );
    })
    .catch(() => setWeather('Ankara', '--', 'Bilinmiyor', 'ri-sun-line', '--', '--', '--', '--'));
}

if (navigator.geolocation) {
  navigator.geolocation.getCurrentPosition(
    pos => getWeatherByCoords(pos.coords.latitude, pos.coords.longitude),
    err => getWeatherByCity('Ankara'),
    {timeout: 5000}
  );
} else {
  getWeatherByCity('Ankara');
}
</script>
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/static/service-worker.js')
      .then(() => console.log("Service Worker kayıt edildi"))
      .catch((error) => console.log("Service Worker hatası:", error));
  }
</script>

<!-- Arama Sonuçları için JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('searchInput');
    const searchResults = document.getElementById('searchResults');
    const searchFilters = document.getElementById('searchFilters');
    const searchFilterBtn = document.getElementById('searchFilterBtn');
    const searchResultsList = document.getElementById('searchResultsList');
    let searchTimeout;

    // Popüler aramalar için tıklama olayı
    document.querySelectorAll('#searchResults .flex-wrap button').forEach(button => {
        button.addEventListener('click', () => {
            searchInput.value = button.textContent.trim();
            performSearch(button.textContent.trim());
        });
    });

    // Arama filtresi toggle
    searchFilterBtn.addEventListener('click', () => {
        searchFilters.classList.toggle('hidden');
    });

    // Arama input değişikliği
    searchInput.addEventListener('input', (e) => {
        clearTimeout(searchTimeout);
        const query = e.target.value.trim();

        if (query.length < 2) {
            searchResults.classList.add('hidden');
            return;
        }

        // Debounce için timeout
        searchTimeout = setTimeout(() => {
            performSearch(query);
        }, 300);
    });

    // Arama fonksiyonu
    function performSearch(query) {
        // Seçili kategorileri al
        const selectedCategories = Array.from(document.querySelectorAll('input[type="checkbox"]:checked'))
            .map(checkbox => checkbox.value);

        // API'ye istek at
        fetch(`/api/search?q=${encodeURIComponent(query)}&${selectedCategories.map(cat => `categories=${cat}`).join('&')}`)
            .then(response => response.json())
            .then(results => {
                displayResults(results);
            })
            .catch(error => {
                console.error('Arama hatası:', error);
                searchResultsList.innerHTML = `
                    <div class="p-4 text-center text-gray-500">
                        Arama sırasında bir hata oluştu
                    </div>
                `;
            });
    }

    // Sonuçları görüntüleme
    function displayResults(results) {
        searchResultsList.innerHTML = '';

        if (results.length === 0) {
            searchResultsList.innerHTML = `
                <div class="p-4 text-center text-gray-500">
                    Sonuç bulunamadı
                </div>
            `;
        } else {
            // Sonuçları doğrudan listele
            results.forEach(result => {
                const resultElement = document.createElement('a');
                resultElement.href = result.link;
                resultElement.className = 'block p-4 hover:bg-gray-50 transition-colors';

                // Eşleşme türüne göre vurgulama
                let highlightClass = '';
                switch(result.match_type) {
                    case 'title':
                        highlightClass = 'text-primary font-semibold';
                        break;
                    case 'keyword':
                        highlightClass = 'text-primary';
                        break;
                    case 'hastalik':
                        highlightClass = 'text-orange-600';
                        break;
                    case 'alt_kategori':
                        highlightClass = 'text-blue-600';
                        break;
                    default:
                        highlightClass = 'text-gray-800';
                        break;
                }

                // Detay bilgilerini hazırla
                let detayHTML = '';
                if (result.detay) {
                    if (result.type === 'bitki') {
                        // Bitki detayları
                        const hastaliklar = result.detay.hastaliklar || [];
                        if (hastaliklar.length > 0) {
                            detayHTML += `
                                <div class="mt-2">
                                    <span class="text-xs text-gray-500">İlgili Hastalıklar:</span>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        ${hastaliklar.map(h => `
                                            <span class="px-2 py-0.5 text-xs bg-orange-100 text-orange-800 rounded-full">
                                                ${h.isim}
                                            </span>
                                        `).join('')}
                                    </div>
                                </div>
                            `;
                        }

                        if (result.detay.cesitler && result.detay.cesitler.length > 0) {
                            detayHTML += `
                                <div class="mt-2">
                                    <span class="text-xs text-gray-500">Çeşitler:</span>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        ${result.detay.cesitler.map(c => `
                                            <span class="px-2 py-0.5 text-xs bg-blue-100 text-blue-800 rounded-full">
                                                ${c}
                                            </span>
                                        `).join('')}
                                    </div>
                                </div>
                            `;
                        }
                         if (result.detay.bolgeler && result.detay.bolgeler.length > 0) {
                            detayHTML += `
                                <div class="mt-2">
                                    <span class="text-xs text-gray-500">Yetiştiği Bölgeler:</span>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        ${result.detay.bolgeler.map(b => `
                                            <span class="px-2 py-0.5 text-xs bg-gray-200 text-gray-700 rounded-full">
                                                ${b}
                                            </span>
                                        `).join('')}
                                    </div>
                                </div>
                            `;
                        }

                    } else if (result.type === 'hastalik') {
                        // Hastalık detayları
                        if (result.detay.belirtiler && result.detay.belirtiler.length > 0) {
                            detayHTML += `
                                <div class="mt-2">
                                    <span class="text-xs text-gray-500">Belirtiler:</span>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        ${result.detay.belirtiler.map(b => `
                                            <span class="px-2 py-0.5 text-xs bg-red-100 text-red-800 rounded-full">
                                                ${b}
                                            </span>
                                        `).join('')}
                                    </div>
                                </div>
                            `;
                        }

                        if (result.detay.mudahale && result.detay.mudahale.length > 0) {
                            detayHTML += `
                                <div class="mt-2">
                                    <span class="text-xs text-gray-500">Müdahale:</span>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        ${result.detay.mudahale.map(m => `
                                            <span class="px-2 py-0.5 text-xs bg-green-100 text-green-800 rounded-full">
                                                ${m}
                                            </span>
                                        `).join('')}
                                    </div>
                                </div>
                            `;
                        }
                         if (result.detay.donem && result.detay.donem.length > 0) {
                            detayHTML += `
                                <div class="mt-2">
                                    <span class="text-xs text-gray-500">Görüldüğü Dönem:</span>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        ${result.detay.donem.map(d => `
                                            <span class="px-2 py-0.5 text-xs bg-yellow-100 text-yellow-800 rounded-full">
                                                ${d}
                                            </span>
                                        `).join('')}
                                    </div>
                                </div>
                            `;
                        }

                    } else if (result.type === 'ilac') {
                        // İlaç detayları
                        if (result.detay.kullanim_alanlari && result.detay.kullanim_alanlari.length > 0) {
                            detayHTML += `
                                <div class="mt-2">
                                    <span class="text-xs text-gray-500">Kullanım Alanları:</span>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        ${result.detay.kullanim_alanlari.map(k => `
                                            <span class="px-2 py-0.5 text-xs bg-gray-100 text-gray-800 rounded-full">
                                                ${k}
                                            </span>
                                        `).join('')}
                                    </div>
                                </div>
                            `;
                        }
                        if (result.detay.hedef_hastaliklar && result.detay.hedef_hastaliklar.length > 0) {
                             detayHTML += `
                                <div class="mt-2">
                                    <span class="text-xs text-gray-500">Hedef Hastalıklar:</span>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        ${result.detay.hedef_hastaliklar.map(h => `
                                            <span class="px-2 py-0.5 text-xs bg-orange-100 text-orange-800 rounded-full">
                                                ${h}
                                            </span>
                                        `).join('')}
                                    </div>
                                </div>
                            `;
                        }
                        if (result.detay.hedef_zararlilar && result.detay.hedef_zararlilar.length > 0) {
                             detayHTML += `
                                <div class="mt-2">
                                    <span class="text-xs text-gray-500">Hedef Zararlılar:</span>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        ${result.detay.hedef_zararlilar.map(z => `
                                            <span class="px-2 py-0.5 text-xs bg-orange-100 text-orange-800 rounded-full">
                                                ${z}
                                            </span>
                                        `).join('')}
                                    </div>
                                </div>
                            `;
                        }
                         if (result.detay.uygulama_zamani && result.detay.uygulama_zamani.length > 0) {
                            detayHTML += `
                                <div class="mt-2">
                                    <span class="text-xs text-gray-500">Uygulama Zamanı:</span>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        ${result.detay.uygulama_zamani.map(u => `
                                            <span class="px-2 py-0.5 text-xs bg-yellow-100 text-yellow-800 rounded-full">
                                                ${u}
                                            </span>
                                        `).join('')}
                                    </div>
                                </div>
                            `;
                        }
                    }
                }

                resultElement.innerHTML = `
                    <div class="flex items-start">
                        <div class="w-8 h-8 flex items-center justify-center text-primary flex-shrink-0">
                            <i class="${result.icon} text-xl"></i>
                        </div>
                        <div class="ml-3 flex-1">
                            <h4 class="text-sm ${highlightClass}">${result.title}</h4>
                            <p class="text-xs text-gray-600 mt-1">${result.description}</p>
                            ${result.match_type === 'hastalik' ? 
                                `<span class="inline-block mt-1 px-2 py-0.5 text-xs bg-orange-100 text-orange-800 rounded-full">
                                    Hastalık eşleşmesi
                                </span>` : ''}
                            ${result.match_type === 'alt_kategori' ? 
                                `<span class="inline-block mt-1 px-2 py-0.5 text-xs bg-blue-100 text-blue-800 rounded-full">
                                    Alt kategori eşleşmesi
                                </span>` : ''}
                            ${detayHTML}
                        </div>
                    </div>
                `;
                searchResultsList.appendChild(resultElement);
            });
        }

        searchResults.classList.remove('hidden');
    }

    // Dışarı tıklandığında sonuçları gizle
    document.addEventListener('click', (e) => {
        if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
            searchResults.classList.add('hidden');
            searchFilters.classList.add('hidden');
        }
    });
});
</script>

<script>
// Hava durumu bilgisini yükle
async function loadWeather() {
    // ... existing code ...
}

// Bilgi kartlarını yükle
async function loadInfoCards() {
    // ... existing code ...
}

// Haberleri yükle
async function loadNews() {
    try {
        const response = await fetch('/api/news');
        const news = await response.json();
        const newsContainer = document.getElementById('news-container');
        newsContainer.innerHTML = ''; // Mevcut placeholder'ları temizle

        if (news.length === 0) {
            newsContainer.innerHTML = '<p class="text-gray-600 text-center w-full">Güncel haber bulunamadı.</p>';
            return;
        }

        news.forEach(item => {
            // Haber kartını tıklanabilir yapmak için <a> etiketi ile sarıyoruz
            const newsItem = `
                <a href="${item.link}" class="flex-none w-64 bg-white rounded-lg shadow-md overflow-hidden border border-gray-100 block hover:shadow-lg transition-shadow duration-200">
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">${item.title}</h3>
                    </div>
                </a>
            `;
            newsContainer.innerHTML += newsItem;
        });

    } catch (error) {
        console.error('Haberler yüklenirken bir hata oluştu:', error);
        document.getElementById('news-container').innerHTML = '<p class="text-red-600 text-center w-full">Haberler yüklenemedi.</p>';
    }
}

// Sayfa yüklendiğinde hava durumu, bilgi kartları ve haberleri yükle
document.addEventListener('DOMContentLoaded', () => {
    loadWeather();
    loadInfoCards();
    loadNews(); // Haberleri yükle
});
</script>

</body>
</html>
